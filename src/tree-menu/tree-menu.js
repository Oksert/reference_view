// import templateUrl from 'src/tree-menu/tree-menu.html'
import $ from 'jquery';
import  templateUrl from './template.html'
import _ from 'lodash'
import serverResponce from '../../serverData.json'
var treeData = require ('../../tree.json')
// import './style.scss'
// import '/src/tree-menu/style.scss'
export default {
    template: templateUrl,
    controller: menuCtrl
}
function menuCtrl () {
    var $ctrl = this

    $ctrl.$onInit = () => {
        
        $ctrl.treeData = {
            children:[{"km_articleid":1,"displayname":"1. Описание Idea Platform","children":[{"km_articleid":19,"displayname":"1.1. Администрирование системы","parent_article":1,"children":[{"km_articleid":21,"displayname":"1.1.2. Запуск","parent_article":19,"children":[]},{"km_articleid":22,"displayname":"1.1.4 Создание и редактирование пользователей","parent_article":19,"children":[]},{"km_articleid":27,"displayname":"1.1.5 Редактирование справочников системы","parent_article":19,"children":[]},{"km_articleid":29,"displayname":"1.1.7 Сообщения администратору","parent_article":19,"children":[]},{"km_articleid":117,"displayname":"1.1.1.Установка","parent_article":19,"children":[{"km_articleid":114,"displayname":"2. Установка на Windows и PostgreSQL","parent_article":117,"children":[]},{"km_articleid":118,"displayname":"1. Установка на Linux и PostgreSQL","parent_article":117,"children":[]},{"km_articleid":119,"displayname":"3. Установка на Windows и MySQL","parent_article":117,"children":[]},{"km_articleid":120,"displayname":"4. Описание параметров файла конфигурации system.properties","parent_article":117,"children":[]},{"km_articleid":121,"displayname":"5. Работа с данными зависящими от стенда в клиентских настройках.","parent_article":117,"children":[]},{"km_articleid":141,"displayname":"6. Установка системы для разработки","parent_article":117,"children":[]}]},{"km_articleid":122,"displayname":"1.1.3. Обновление","parent_article":19,"children":[{"km_articleid":109,"displayname":"Обновление сервера приложений","parent_article":122,"children":[]},{"km_articleid":123,"displayname":"Обновление сервера приложений на Linux с SAAS Linux DEV","parent_article":122,"children":[]},{"km_articleid":124,"displayname":"Обновление сервера приложений на Windows","parent_article":122,"children":[]}]},{"km_articleid":128,"displayname":"1.1.6 Загрузка данных из Excel-файла","parent_article":19,"children":[{"km_articleid":28,"displayname":"1.2 Загрузка данных из внешнего файла","parent_article":128,"children":[]},{"km_articleid":113,"displayname":"1.1 Генерация шаблона для загрузки данных","parent_article":128,"children":[]}]}]},{"km_articleid":30,"displayname":"1.2. Доработка системы","parent_article":1,"children":[{"km_articleid":23,"displayname":"1.2.7 Предоставление прав доступа пользователю","parent_article":30,"children":[{"km_articleid":24,"displayname":"Профиль пользователя","parent_article":23,"children":[]},{"km_articleid":25,"displayname":"Группы доступа","parent_article":23,"children":[]},{"km_articleid":26,"displayname":"Карты доступа","parent_article":23,"children":[]}]},{"km_articleid":39,"displayname":"1.2.15 Добавление и редактирование правил","parent_article":30,"children":[{"km_articleid":40,"displayname":"Серверные правила","parent_article":39,"children":[]},{"km_articleid":41,"displayname":"Клиентские правила","parent_article":39,"children":[]},{"km_articleid":104,"displayname":"Порядок выполнения правил","parent_article":39,"children":[]}]},{"km_articleid":42,"displayname":"1.2.3 Добавление и редактирование workflow","parent_article":30,"children":[{"km_articleid":43,"displayname":"1. Добавление и редактирование объекта workflow","parent_article":42,"children":[]},{"km_articleid":44,"displayname":"2. Добавление и редактирование схемы workflow","parent_article":42,"children":[]},{"km_articleid":46,"displayname":"3. Права доступа на переход workflow","parent_article":42,"children":[]},{"km_articleid":47,"displayname":"4. Добавление и редактирование правил по переходам workflow","parent_article":42,"children":[]},{"km_articleid":48,"displayname":"5. Добавление и редактирование оповещений по переходу workflow","parent_article":42,"children":[]}]},{"km_articleid":49,"displayname":"1.2.4. Создание и редактирование отчетов","parent_article":30,"children":[{"km_articleid":50,"displayname":"1. Отчеты типа «Простая таблица» и «Таблица для дашборда»","parent_article":49,"children":[]},{"km_articleid":52,"displayname":"2. Отчеты типа «Пирог» и «Столбчатая диаграмма»","parent_article":49,"children":[]},{"km_articleid":53,"displayname":"4. Отчеты типа «Расписание»","parent_article":49,"children":[]},{"km_articleid":54,"displayname":"6. Настройка переходов в дочерние отчеты","parent_article":49,"children":[]},{"km_articleid":55,"displayname":"5. Добавление отчетов на карточку объекта","parent_article":49,"children":[]},{"km_articleid":132,"displayname":"3. Отчеты типа \"График\"","parent_article":49,"children":[]},{"km_articleid":143,"displayname":"7. Отчеты типа Multiplot","parent_article":49,"children":[]}]},{"km_articleid":56,"displayname":"1.2.5 Создание и редактирование дашбордов","parent_article":30,"children":[]},{"km_articleid":58,"displayname":"1.2.7 Настройка предупреждений","parent_article":30,"children":[]},{"km_articleid":59,"displayname":"1.2.8 Настройка оповещений","parent_article":30,"children":[]},{"km_articleid":60,"displayname":"1.2.6 Настройка меню","parent_article":30,"children":[]},{"km_articleid":61,"displayname":"1.2.10 Объекты и классы АPI системы","parent_article":30,"children":[{"km_articleid":62,"displayname":"Серверные методы и классы API системы","parent_article":61,"children":[]},{"km_articleid":63,"displayname":"Клиентские классы и методы API системы","parent_article":61,"children":[]},{"km_articleid":64,"displayname":"Пользовательский API системы (Class Library)","parent_article":61,"children":[]}]},{"km_articleid":65,"displayname":"1.2.9 Настройка фоновых процессов","parent_article":30,"children":[]},{"km_articleid":66,"displayname":"1.2.12 Настройка переноса данных из одной инсталяции Системы в другую","parent_article":30,"children":[]},{"km_articleid":105,"displayname":"1.2.13 Работа объекта календарь, создание событий календаря из объектов системы","parent_article":30,"children":[]},{"km_articleid":129,"displayname":"1.2.11. Настройка печатных форм","parent_article":30,"children":[{"km_articleid":67,"displayname":"Настройка выгрузки в Word формы одной записи","parent_article":129,"children":[]},{"km_articleid":112,"displayname":"Печатные формы отчетов в Excel","parent_article":129,"children":[]}]},{"km_articleid":130,"displayname":"​1.2.17 Описание внешнего REST-API системы","parent_article":30,"children":[]},{"km_articleid":134,"displayname":"1.2.1 Добавление и редактирование объектов системы","parent_article":30,"children":[{"km_articleid":31,"displayname":"1. Добавление и редактирование таблиц","parent_article":134,"children":[]},{"km_articleid":33,"displayname":"3. Добавление и редактирование полей таблиц","parent_article":134,"children":[]},{"km_articleid":34,"displayname":"4. Добавление и редактирование форматов полей","parent_article":134,"children":[]},{"km_articleid":35,"displayname":"5. Добавление и редактирование виртуальных полей","parent_article":134,"children":[]},{"km_articleid":36,"displayname":"8. Добавление и редактирование индексов","parent_article":134,"children":[]},{"km_articleid":37,"displayname":"7. Редактирование отображений и формы поиска","parent_article":134,"children":[]},{"km_articleid":38,"displayname":"11. Настройка кнопок в объектах","parent_article":134,"children":[]},{"km_articleid":57,"displayname":"9. Добавление и редактирование меппинга полей объектов","parent_article":134,"children":[]},
        {"km_articleid":116,"displayname":"6. Добавление настроек отображения объекта","parent_article":134,"children":[]},{"km_articleid":131,"displayname":"10 Работа с полем типа HTML, реализация ссылок на отчеты","parent_article":134,"children":[]},{"km_articleid":135,"displayname":"2. Добавление и редактирование таблиц типа Запрос","parent_article":134,"children":[]}]},{"km_articleid":142,"displayname":"1.2.18. Настройка git для экспорта/импорта бизнес-логики","parent_article":30,"children":[]}]},{"km_articleid":136,"displayname":"1.3. Описание структуры клиента Idea Platform","parent_article":1,"children":[]},{"km_articleid":137,"displayname":"1.4. Описание структуры мобильного клиента Idea Platform","parent_article":1,"children":[]},{"km_articleid":138,"displayname":"1.5. Описание деплоя клиента и настроек nginx","parent_article":1,"children":[]},{"km_articleid":139,"displayname":"1.6. Описание нагрузочного тестирования","parent_article":1,"children":[]},{"km_articleid":140,"displayname":"1.7. Описание E2E и модульного тестирования","parent_article":1,"children":[]}]},{"km_articleid":2,"displayname":"Модуль управления задачами","children":[]},{"km_articleid":3,"displayname":"Тестовая статья (ws DEMO)","children":[{"km_articleid":4,"displayname":"Тема !123!","parent_article":3,"children":[]}]},{"km_articleid":6,"displayname":"Anylogic","children":[{"km_articleid":45,"displayname":"Отлавливание ошибок в AnyLogic","parent_article":6,"children":[]},{"km_articleid":77,"displayname":"Составление расписаний","parent_article":6,"children":[]},{"km_articleid":78,"displayname":"Как готовить JAR файлы с моделями","parent_article":6,"children":[]}]},{"km_articleid":7,"displayname":"Java","children":[{"km_articleid":68,"displayname":"Рекомендации к стилю кода","parent_article":7,"children":[]},{"km_articleid":69,"displayname":"Интересные задачи по Java SE","parent_article":7,"children":[]},{"km_articleid":70,"displayname":"Exceptions и обработка ошибок в Java","parent_article":7,"children":[]},{"km_articleid":71,"displayname":"Коллекции Java","parent_article":7,"children":[]},{"km_articleid":72,"displayname":"Профилирование в Java","parent_article":7,"children":[]},{"km_articleid":73,"displayname":"Использование JBoss в Eclipse","parent_article":7,"children":[]},{"km_articleid":74,"displayname":"Адрес страницы в JBoss","parent_article":7,"children":[]},{"km_articleid":75,"displayname":"Настройки JBoss","parent_article":7,"children":[{"km_articleid":76,"displayname":"Настройка исходящей почты","parent_article":75,"children":[]}]},{"km_articleid":115,"displayname":"Обновление Java на Centos","parent_article":7,"children":[]}]},{"km_articleid":8,
        "displayname":"Базы данных","children":[{"km_articleid":79,"displayname":"MySQL","parent_article":8,"children":[{"km_articleid":80,"displayname":"Import - Export database MySQL 5.6","parent_article":79,"children":[]}]},{"km_articleid":81,"displayname":"Статья по основам реляционных баз данных","parent_article":8,"children":[]},{"km_articleid":82,"displayname":"Сайт с задачами по SQL","parent_article":8,"children":[]},{"km_articleid":83,"displayname":"Oracle","parent_article":8,"children":[{"km_articleid":84,"displayname":"Как ускорить загрузку данных в Oracle","parent_article":83,"children":[]},{"km_articleid":85,"displayname":"Export Database","parent_article":83,"children":[]},{"km_articleid":86,"displayname":"Import Database","parent_article":83,"children":[]}]},{"km_articleid":106,"displayname":"PostgreSQL","parent_article":8,"children":[{"km_articleid":107,"displayname":"Cоздание dblink для связки mssql-postgres на примере БД ЦУТР","parent_article":106,"children":[]},{"km_articleid":108,"displayname":"Как снять и развернуть дамп PostgreSQL","parent_article":106,"children":[]}]}]},{"km_articleid":9,"displayname":"Soft Skills","children":[{"km_articleid":87,"displayname":"draft Совещание правила проведения","parent_article":9,"children":[]},{"km_articleid":88,"displayname":"Видеокурс по ведению протокола","parent_article":9,"children":[]},{"km_articleid":89,"displayname":"Бизнес-презентации от Радислава Гандапаса","parent_article":9,"children":[]},{"km_articleid":90,"displayname":"draft Правила деловой переписки email","parent_article":9,"children":[]},{"km_articleid":91,"displayname":"Time management","parent_article":9,"children":[]}]},{"km_articleid":10,"displayname":"ВСМ","children":[{"km_articleid":92,"displayname":"Параметры стендов VSM","parent_article":10,"children":[]}]},{"km_articleid":11,"displayname":"Бизнес-процессы (best practices)","children":[{"km_articleid":93,"displayname":"Что такое ITSM","parent_article":11,"children":[]}]},{"km_articleid":12,"displayname":"HP SM","children":[{"km_articleid":94,"displayname":"Генератор модуля с преднастроенной логикой","parent_article":12,"children":[]},{"km_articleid":95,"displayname":"Генерации печатных форм (файлов .docx)","parent_article":12,"children":[]},{"km_articleid":96,"displayname":"Брендинг HP SM","parent_article":12,"children":[]},{"km_articleid":97,"displayname":"Ссылочная целостность","parent_article":12,"children":[]},{"km_articleid":98,"displayname":"Шаблоны","parent_article":12,"children":[]},{"km_articleid":99,"displayname":"История","parent_article":12,"children":[]},{"km_articleid":100,"displayname":"Настройка языка для входа в систему","parent_article":12,"children":[]},{"km_articleid":101,"displayname":"Как сделать язык по умолчанию в вебе русским","parent_article":12,"children":[]},{"km_articleid":102,"displayname":"Как изменить страницу логина в HP SM","parent_article":12,"children":[]}]},{"km_articleid":13,"displayname":"SVN","children":[{"km_articleid":103,"displayname":"Как исключить из коммита папку","parent_article":13,"children":[]}]},{"km_articleid":14,"displayname":"Continuous Integration","children":[{"km_articleid":110,"displayname":"Запуск автотестов","parent_article":14,"children":[]},{"km_articleid":111,"displayname":"Про Jenkins","parent_article":14,"children":[]}]},{"km_articleid":15,"displayname":"Электронная библиотека СУТР РПМ","children":[]},{"km_articleid":133,"displayname":"Тестовая статья","children":[]}]
        }
        var count = 0;
        $(function () {
            $('.tree li:has(ul)').addClass('parent_li').find(' > span').attr('title', 'Collapse this branch');
            $('.tree li.parent_li > span').on('click', function (e) {
                var children = $(this).parent('li.parent_li').find(' > ul > li');
                if (children.is(':visible')) {
                    children.hide('fast');
                    $(this).attr('title', 'Expand this branch').find(' > i').addClass('icon-plus-sign').removeClass('icon-minus-sign');
                } else {
                    children.show('fast');
                    $(this).attr('title', 'Collapse this branch').find(' > i').addClass('icon-minus-sign').removeClass('icon-plus-sign');
                }
                e.stopPropagation();
            });
            $('.tree li.parent_li > span').trigger('click')
        });
        var windowHeight = $(window).height()
        var headerHeight = $('#header').height()
        $('iframe').height(windowHeight - headerHeight - 100)
        $('.tree').height(windowHeight -  headerHeight - 100)
        var $window = $(window).on('resize', function(){
            windowHeight = $(window).height()
            headerHeight = $('#header').height()
            $('iframe').height(windowHeight -  headerHeight - 100)
            $('.tree').height(windowHeight -  headerHeight - 100)
        })
        $ctrl.clickArticle= (name)=> {
            $ctrl.name = name
        }
    }
}